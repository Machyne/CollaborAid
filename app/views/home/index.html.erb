<%= stylesheet_link_tag "home", media: "all", "data-turbolinks-track" => true %>
<div class="container" id="home-cont">
  <div class="row">
    <div class="col-md-12">
      <h1>Welcome to CollaborAid!</h1>
    </div>
  </div>
  <div class="row map-row">
    <div class="col-md-12">
      <div id="map"></div>
    </div>
  </div>
</div>
<%= javascript_tag do %>
  var MAP_URL = '<%= APP_CONFIG["mapbox"] %>';
  // The GeoJSON representing the two point features
  var geoJson = {
      type: 'FeatureCollection',
      features: [
      <% @projects.to_enum.with_index.each do |proj, i| %>
      <%= i==0 ? '' : ','%>{
          type: 'Feature',
          properties: {
              title: '<h1><%= proj.name %></h1>',
              description:  '<p>'+
                              '<strong>Implementing Organization:</strong>'+
                              '<span><%= proj.oversee %></span>'+
                              '<strong>Primary Beneficiaries:</strong>'+
                              '<span><%= proj.bens.join ", " %></span>'+
                              '<strong>Sectors:</strong>'+
                              '<span><%= ([proj.psector]+proj.asectors).join ", " %></span>'+
                              '<strong>Description:</strong>'+
                              '<span><%= proj.description %></span>'+
                            '</p>'+
                            '<small>Click <%= link_to 'here', proj %> to see more</small>',
              'marker-color': '#f00',
              'marker-size': 'large',
          },
          geometry: {
              type: 'Point',
              coordinates: <%= proj.location %>
          }
      }
      <% end %>
      ]
  };
<% end %>
<%= javascript_include_tag "home", "data-turbolinks-track" => true %>
